//Bluewave Charts 1.0.5
if(!bluewave)var bluewave={};if(bluewave.chart||(bluewave.chart={}),bluewave.chart.Line=function(t){var e=this,a={color:"#6699CC",opacity:1,width:1,style:"solid",fill:{color:"#6699CC",startOpacity:0,endOpacity:0},point:{color:"#6699CC",radius:0},label:"",smoothing:"none",smoothingValue:0};this.setColor=function(e){e=l(e),e&&(t.color=e)},this.setOpacity=function(e){e=r(e),isNaN(e)||(t.opacity=e)},this.setWidth=function(e){e=parseFloat(e),!isNaN(e)&&0<e&&(t.width=e)},this.setStyle=function(e){e&&(e=(e+"").toLowerCase(),("solid"===e||"dashed"===e||"dotted"===e)&&(t.style=e))},this.setFill=function(e){if(!e)delete t.fill;else{var a=l(e.color);a&&(t.fill.color=a);var i=r(e.startOpacity);isNaN(i)||(t.fill.startOpacity=i);var i=r(e.endOpacity);isNaN(i)||(t.fill.endOpacity=i)}},this.setPoint=function(e){if(!e)delete t.point;else{var a=l(e.color);a&&(t.point.color=a);var r=parseFloat(e.radius);!isNaN(r)&&0<r&&(t.point.radius=r)}},this.setLabel=function(e){t.label=e},this.setSmoothing=function(e){if(e){switch(e=(e+"").toLowerCase(),e){case"spline":case"simple spline":e="spline";break;case"moving average":case"movingaverage":e="movingAverage";break;case"kernel density estimation":case"kde":e="kde";break;case"curvenatural":e="curveNatural";break;default:e="none"}t.smoothing=e}},this.setSmoothingValue=function(e){e=parseFloat(e),isNaN(e)||0>e||(t.smoothingValue=e)},this.getConfig=function(){return t},this.setConfig=function(t){for(var a in t)if(t.hasOwnProperty(a)){var l="set"+a.substring(0,1).toUpperCase()+a.substring(1);e[l]&&e[l].apply(e,[t[a]])}},this.getColor=()=>t.color,this.getWidth=()=>t.width,this.getStyle=()=>t.style,this.getFill=()=>t.fill,this.getPoint=()=>t.point,this.getLabel=()=>t.label,this.getSmoothing=()=>t.smoothing,this.getSmoothingValue=()=>t.smoothingValue,this.clone=function(){let e=Object.assign({},t);return new bluewave.chart.Line(e)};var l=function(t){return t},r=function(t){return t=parseFloat(t),isNaN(t)?null:0>t||1<t?null:t};(function(){if(!t)return void(t=a);var l=t;t=a,e.setConfig(l)})()},!bluewave)var bluewave={};if(bluewave.charts||(bluewave.charts={}),bluewave.charts.ScatterChart=function(t,e){var i,n,o,s,c,h,a=Math.min,l=Number.MAX_VALUE,r=Math.max,u=this,d={pointColor:"#6699cc",pointRadius:7,pointOpacity:.8,pointLabels:!1,showRegLine:!1,showTooltip:!1},g=function(){u.setConfig(e),w(t,function(t,e){i=t,n=e})};this.setConfig=function(t){e=t?k(t,d):d},this.clear=function(){n&&n.selectAll("*").remove()},this.update=function(t,a,l){u.clear(),0<arguments.length&&(1===arguments.length||("string"==typeof a?(e.xAxis=a,e.yAxis=l):(u.setConfig(arguments[0]),t=arguments[1]))),A(u,function(){p(t)})},this.getSVG=function(){return i},this.getPointLabel=function(t){return""},this.getPointRadius=function(t){return e.pointRadius},this.getPointColor=function(t){return e.pointColor},this.getPointOpacity=function(t){return e.pointOpacity},this.getTooltipLabel=function(t){return e.xAxis+": "+t[e.xAxis]+"<br/>"+e.yAxis+": "+t[e.yAxis]},this.onClick=function(t,e,a){};var p=function(t){var a=javaxt.dhtml.utils.getRect(i.node()),l=a.width,d=a.height,g=d,p=l;o=n.append("g"),o.attr("width",l).attr("height",d);let y=e.xAxis,x=e.yAxis;if(!y||!x)return;if(v(t)&&v(t[0])&&(t=t[0]),0==t.length)return;var k=T(o,p,g,y,x,t,null,e);c=k.x,h=k.y;var b=k.margin;if(b){var A=b.left,w=b.right,L=b.top,S=b.bottom,R=0;if(e.pointLabels){var V=o.append("g");V.selectAll("text").data(t).enter().append("text").attr("x",0).attr("y",0).attr("text-anchor","start").attr("font-size",10).text(function(t){return u.getPointLabel(t)});var P=V.node().getBBox();V.remove(),R=r(P.width,R)}(0<L||0<S||0<A||0<w)&&(g-=L+S,p-=A+w,o.selectAll("*").remove(),o.attr("transform","translate("+A+","+L+")"),k=T(o,p,g,y,x,t,null,e)),b={top:L,right:w,bottom:S,left:A}}c=k.x,h=k.y;let M=C(t[y]);if(e.pointLabels){let t=R/p;c=F({scale:k.x,band:k.xBand},[0,p],t).scale,D(o,k.xAxis,c,null,null,g)}(e.xGrid||e.yGrid)&&E(o,c,h,g,p,e.xGrid,e.yGrid);var O,G=function(t){return"date"===M?c(new Date(t[y])):c(t[y])},z=function(t){return h(t[x])};!0===e.showTooltip&&(O=B());var Y=function(t,e){if(O){var a=u.getTooltipLabel(e);O.html(a).show()}d3.select(this).transition().duration(100).attr("opacity","0.8")},K=function(t){O&&O.style("top",t.clientY+"px").style("left",t.clientX+20+"px")},j=function(){O&&O.hide(),d3.select(this).transition().duration(100).attr("opacity","1")},I=o.append("g");if(I.attr("name","points"),I.selectAll("*").data(t).enter().append("circle").attr("dataset",0).attr("cx",G).attr("cy",z).attr("r",function(t){return u.getPointRadius(t)}).style("fill",function(t){return u.getPointColor(t)}).style("opacity",function(t){return u.getPointOpacity(t)}).style("stroke","white").on("mouseover",Y).on("mousemove",K).on("mouseleave",j).on("click",function(t,e){var a=parseInt(d3.select(this).attr("dataset"));u.onClick(this,a,e)}),!0===e.pointLabels){var N=o.append("g");N.attr("name","labels"),N.append("g").selectAll("text").data(t).enter().append("text").attr("x",function(t){var e=G(t),a=u.getPointRadius(t);return e+a+1}).attr("y",z).attr("font-size",10).text(function(t){return u.getPointLabel(t)}).on("mouseover",Y).on("mousemove",K).on("mouseleave",j).on("click",function(t){})}if(e.showRegLine){var X=m(t,y,x,d3.min(t,function(t){return t[y]}),d3.min(t,function(t){return t[x]}),c,h);s=d3.line().x(function(t){return t[0]}).y(function(t){return t[1]}),o.append("path").datum(X).attr("dataset",0).attr("d",s).attr("stroke",u.getPointColor()).attr("stroke-linecap","round").attr("stroke-width",2).on("click",function(t,e){var a=parseInt(d3.select(this).attr("dataset"));u.onClick(this,a,e)})}var P=f(o);if(P.width=1.1*(P.maxX-P.minX),P.height=1.1*(P.maxY-P.minY),P.width>l||P.height>d){var H,U=P.width-l,W=P.height-d;U>W?(H=l/P.width,1<H&&(H=1+(1-H))):W>U&&(H=d/P.height),L=(L+W/2)*H,o.attr("transform","translate("+A+","+L+") scale("+H+")")}},m=function(t,e,a,l,r,i,o){var s=t.length,n=[],d=[],c=[];t.forEach(t=>{var l={};l.x=parseFloat(i(t[e])),l.y=parseFloat(o(t[a])),l.mult=l.x*l.y,n.push(l),d.push(parseFloat(i(t[e]))),c.push(parseFloat(o(t[a])))});var h=0,u=0,g=0,p=0,f=0,k=0,A=0,w=d.length;if(w!=c.length)throw new Error("The values in xAxis and yAxis need to have same size!");if(0===w)return[[],[]];for(var C=0;C<w;C++)k=d[C],A=c[C],h+=k,u+=A,p+=k*k,g+=k*A,f++;for(var L=(f*g-h*u)/(f*p-h*h),m=u/f-L*h/f,b=[],C=0;C<w;C++)k=d[C],A=k*L+m,b.push([k,A]);return b},f=function(t){var e=l,i=0,n=l,o=0;return t.selectAll("*").each(function(){var t=javaxt.dhtml.utils.getRect(d3.select(this).node());e=a(t.left,e),i=r(t.right,i),n=a(t.top,n),o=r(t.bottom,o)}),{minX:e,maxX:i,minY:n,maxY:o}},k=javaxt.dhtml.utils.merge,b=bluewave.chart.utils.onRender,v=bluewave.chart.utils.isArray,A=bluewave.chart.utils.checkSVG,w=bluewave.chart.utils.initChart,C=bluewave.chart.utils.getType,L=bluewave.chart.utils.getScale,T=bluewave.chart.utils.drawAxes,S=bluewave.chart.utils.drawLabels,E=bluewave.chart.utils.drawGridlines,F=bluewave.chart.utils.extendScale,D=bluewave.chart.utils.reDrawAxes,B=bluewave.chart.utils.createTooltip;g()},!bluewave)var bluewave={};if(bluewave.charts||(bluewave.charts={}),bluewave.charts.CalendarChart=function(t,e){var a,l,r=this,i={dayLabel:!0,yearLabel:!0,date:"date",value:"value",weekday:"monday",cellSize:17,colors:["#fff","#ebf5dc","#cbe9a5","#2a671a"],showTooltip:!1},n=function(){r.setConfig(e),c(t,function(t,e){a=t,l=e})};this.setConfig=function(t){e=t?s(t,i):i},this.onClick=function(t,e){},this.getCell=function(t){t=new Date(t);var e=t.getFullYear(),a=t.getMonth(),r=t.getDate(),i=null;return l.selectAll("rect").each(function(t){var l=t.getFullYear(),n=t.getMonth(),o=t.getDate();l===e&&n===a&&o===r&&(i=this)}),i},this.getTooltipLabel=function(t){return d3.utcFormat("%m/%d/%Y")(t.date)+"<br/>"+d3.format(",")(t.value)},this.clear=function(){l&&l.selectAll("*").remove()},this.update=function(t,a){r.clear(),1<arguments.length?e=s(t,i):a=arguments[0],d(r,function(){o(a)})},this.getSVG=function(){return a};var o=function(t){r.clear();var a=e,n=e.cellSize,o=e.weekday,s=t=>"SMTWTFS"[t];t.forEach(t=>{var a=t[e.date],l=t[e.value];t[e.date]=new Date(a),t[e.value]=bluewave.chart.utils.parseFloat(l)}),t.sort(function(t,a){return a[e.date].getTime()-t[e.date].getTime()});var c=[],p=[],y={};t.forEach(t=>{var a=t[e.date],l=t[e.value];c.push(a),p.push(l);var r=a.getUTCFullYear();y[r+""]=r}),y=Object.values(y),y.sort(function(t,e){return e-t});const m="sunday"===o?t=>t:t=>(t+6)%7,f="sunday"===o?d3.utcSunday:d3.utcMonday,x="weekday"===o?5:7,k=n*(x+2);var b,v=10,A=g(p,10),w=u(A.length+1,e.colors),C=function(t){for(var e=0;e<A.length-1;e++){var a=A[e],l=A[e+1],r=w[e];if(t>=a&&t<l)return r;if(t==A[A.length-1])return w[w.length-1]}};!0===e.showTooltip&&(b=h());var L=function(t,e){if(b){var a=F.nodes().indexOf(this),l=r.getTooltipLabel({date:e,value:p[a]});b.html(l).show()}d3.select(this).transition().duration(100).attr("opacity","0.8")},T=function(t){b&&b.style("top",t.clientY+"px").style("left",t.clientX+20+"px")},S=function(){b&&b.hide(),d3.select(this).transition().duration(100).attr("opacity","1")},E=l.selectAll("*").data(y).join("g").attr("transform",(t,e)=>`translate(40.5,${k*e+1.5*n})`);a.yearLabel&&E.append("text").attr("class","chart-axis-label").attr("x",-5).attr("y",-5).attr("text-anchor","end").text(t=>t),a.dayLabel&&E.append("g").attr("class","tick").attr("text-anchor","middle").selectAll("text").data(function(t){var e=d3.range(7);return e.forEach(function(a,l){e[l]={day:a,year:t}}),e}).join("text").attr("x",-10).attr("y",function(t){return(m(t.day)+.5)*n}).attr("dy","0.31em").text(function(t){var e=t.day,a=t.year,l=!1;if(c.every(function(t){if(t.getUTCFullYear()===a){var r=t.getUTCDay();if(r===e)return l=!0,!1}return!0}),l||0<e&&6>e)return s(e)});var F=E.append("g").selectAll("*").data(function(t){var e=[];return c.forEach(function(a){a.getUTCFullYear()===t&&e.push(a)}),e}).join("rect").attr("width",n-1).attr("height",n-1).attr("x",t=>f.count(d3.utcYear(t),t)*n+.5).attr("y",t=>m(t.getUTCDay())*n+.5).attr("fill",function(t,a){var l=p[a],r=C(l);return r===e.colors[0]&&0<l&&(r=w[1]),r}).on("mouseover",L).on("mousemove",T).on("mouseleave",S).on("click",function(t,e){var a=F.nodes().indexOf(this);r.onClick(this,{date:e,value:p[a]})}),D=E.append("g").selectAll("g").data(function(t){var e,a;return c.forEach(function(l){l.getUTCFullYear()===t&&(!a&&(a=l),e=l)}),e=new Date(e.getTime()),a=new Date(a.getTime()),e.setMonth(e.getMonth()-1),a.setMonth(a.getMonth()+1),d3.utcMonths(e,a)}).join("g");D.filter((t,e)=>e).append("path").attr("fill","none").attr("stroke","#fff").attr("stroke-width",3).attr("d",function(t){const e=Math.max(0,Math.min(x,m(t.getUTCDay()))),a=f.count(d3.utcYear(t),t);return`${0===e?`M${a*n},0`:e===x?`M${(a+1)*n},0`:`M${(a+1)*n},0V${e*n}H${a*n}`}V${x*n}`});var B={};D.append("text").attr("class","tick").attr("x",t=>f.count(d3.utcYear(t),f.ceil(t))*n+2).attr("y",-5).text(function(t){var e=d3.utcFormat("%b")(t),a=d3.utcFormat("%Y")(t),l=a+"-"+e,r=!1;if(c.every(function(t){var e=d3.utcFormat("%b")(t),a=d3.utcFormat("%Y")(t),i=a+"-"+e;return i!==l||(r=!0,!1)}),r&&!B[l])return B[l]=!0,e})},s=javaxt.dhtml.utils.merge,d=bluewave.chart.utils.checkSVG,c=bluewave.chart.utils.initChart,h=bluewave.chart.utils.createTooltip,u=bluewave.chart.utils.getColorRange,g=bluewave.chart.utils.getNaturalBreaks;n()},!bluewave)var bluewave={};if(bluewave.chart||(bluewave.chart={}),bluewave.chart.utils={initChart:function(t,e,a){var l,r=function(){var t=l.append("g");e&&e.apply(a,[l,t])};if(t instanceof d3.selection)l=t,r();else if(t instanceof SVGElement)l=d3.select(t),r();else{var i=d3.select(t).append("div").classed("svg-container",!0),l=i.append("svg").attr("preserveAspectRatio","xMidYMid meet").attr("height","100%").attr("width","100%").attr("viewBox","0 0 600 400").classed("svg-content-responsive",!0);bluewave.chart.utils.onRender(t,function(){setTimeout(function(){var e=t.offsetWidth,a=t.offsetHeight;l.attr("viewBox",`0 0 ${e} ${a}`),r()},200)})}},checkSVG:function(t,e){var a=t.getSVG();if(!a){var l,r=function(){var a=t.getSVG();a?(clearTimeout(l),e&&e.apply(t,[a])):l=setTimeout(r,100)};l=setTimeout(r,100)}else e&&e.apply(t,[a])},onRender:function(t,e){var a=t.offsetWidth;if(0===a||isNaN(a)){var l,r=function(){var a=t.offsetWidth;0===a||isNaN(a)?l=setTimeout(r,100):(clearTimeout(l),e&&e.apply(t,[t]))};l=setTimeout(r,100)}else e&&e.apply(t,[t])},drawGridlines:function(t,e,a,l,r,i,n){i&&t.append("g").attr("class","grid").attr("transform","translate(0,"+l+")").call(d3.axisBottom(e).tickSize(-l).tickFormat("")),n&&t.append("g").attr("class","grid").call(d3.axisLeft(a).tickSize(-r).tickFormat(""))},drawLabels:function(t,e,a,l,r,i,n,o){if(e){var s=l;i&&(s+=i.bottom-2),t.append("text").attr("x",r/2).attr("y",s).style("text-anchor","middle").text(n)}if(a){var d=0;i&&(d-=i.left),t.append("text").attr("transform","rotate(-90)").attr("x",0-l/2).attr("y",d).attr("dy","1em").style("text-anchor","middle").text(o)}},drawAxes:function(e,a,l,i,n,o,s,d,c){var h=Math.min,u=Number.MAX_VALUE,g=Math.max;d||(d={});var p=bluewave.chart.utils.getType,m=bluewave.chart.utils.getScale,f=bluewave.chart.utils.getDateFormat,k=[],b=[];o.forEach(t=>{k.push(t[i]),b.push(t[n])});var v=p(k),A=p(b);if("barChart"==c&&("date"==v&&(v="string"),"date"==A&&(A="string"),"number"==v||"currency"==v)){var w=d.layout;if("vertical"===w){var C=u,L=0;k.forEach(t=>{var e=bluewave.chart.utils.parseFloat(t);C=h(e,C),L=g(e,L)}),d.xMin=C}}var T=m(i,v,[0,a],o,s,null,d.xMin,d.xMax),S=T.scale,x=T.band,E="logarithmic"===d.scaling?"logarithmic":"linear";T=m(n,A,[l,0],o,s,E);var F,D=T.scale,y=T.band,B=10,R=S.domain().length,V=R*B<a,P=function(t,e){let l=parseInt(a/B);return!(0!==e)||!(e%l)},M=function(t,e){var a,l,r;t.selectAll("text").each(function(t,i,n){var o=n[i].textContent;if("number"===e){if(isNaN(a)&&(a=0,n.forEach(function(t){var e=0==bluewave.chart.utils.parseFloat(t.textContent)%1;e&&a++})),a==n.length){var s=d3.format(",");n[i].textContent=s(o)}}else if("date"===e){if(l||(l={},r={},n.forEach(function(t){var e=new Date(t.textContent),a=e.getFullYear(),i=e.getDate();l[a+""]=!0,r[i+""]=!0}),l=Object.keys(l),r=Object.keys(r)),1<l.length){if(1==r.length){var s=d3.timeFormat("%m/%y");o=s(t)}}else if(1==r.length){var s=d3.timeFormat("%b");o=s(t)}0===o.indexOf("0")&&(o=o.substring(1)),o=o.replaceAll("/0","/"),n[i].textContent=o}})},O=function(t,e){var a;if("date"===t)a=d3.timeFormat(f(e));else if("number"===t){var l=1;a=d3.format(".1f")}return a},G=function(t){var e=[];return t.selectAll("text").each(function(t,a){var l=javaxt.dhtml.utils.getRect(this);e.push({left:l.x,right:l.x+l.width,top:l.y,bottom:l.y+l.height})}),e},z=function(t,e=0){var a=!1;t.forEach(function(t){t.top-=e,t.left-=e,t.right+=e,t.bottom+=e});for(var l,r=0;r<t.length;r++){l=t[r];for(var n=0;n<t.length;n++)if(n!==r){var o=t[n];if(javaxt.dhtml.utils.intersects(l,o)){a=!0;break}}if(a)break}return a},Y=O(v,d.xFormat);!0===d.xTicks||!1===d.xTicks||(F=d.xTicks);var K=e.append("g").attr("transform","translate(0,"+l+")");if(!1===d.xTicks)K.call(d3.axisBottom(S).ticks(F).tickSize([0,0])),K.selectAll("text").each(function(t,e){d3.select(this).remove()}),K.selectAll("path").each(function(t,e){d3.select(this).remove()});else{K.call(d3.axisBottom(S).ticks(F).tickValues(V?null:S.domain().filter(P)).tickFormat(Y)),d.xFormat||M(K,v);var j=G(K),I=z(j,0);I&&K.selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end")}var N=O(A,d.yFormat),X=e.append("g");if(!1===d.yTicks)X.call("linear"===E?d3.axisLeft(D).tickFormat(N).tickSize([0,0]):d3.axisLeft(D).ticks(10,",").tickFormat(N).tickSize([0,0])),X.selectAll("text").each(function(t,e){d3.select(this).remove()}),X.selectAll("path").each(function(t,e){d3.select(this).remove()});else{X.call("linear"===E?d3.axisLeft(D).tickFormat(N):d3.axisLeft(D).ticks(10,",").tickFormat(N)),d.yFormat||M(X,A);var H=G(X),U=z(H,-1);if(U){let t=X.selectAll("text").size();X.selectAll("text").attr("visibility",function(e,a){return t%2?0==(a+1)%2?"hidden":"visible":0==a%2?"hidden":"visible"})}}var W=javaxt.dhtml.utils.getRect(K.node()),_=javaxt.dhtml.utils.getRect(X.node()),q=u,Z=0,J=u,Q=0;K.selectAll("line").each(function(t,e){var a=javaxt.dhtml.utils.getRect(this);q=h(a.x,q),Z=g(a.x+a.width,Z)}),X.selectAll("line").each(function(t,e){var a=javaxt.dhtml.utils.getRect(this);J=h(a.y,J),Q=g(a.y+a.height,Q)}),X.selectAll("path").each(function(t,e){var a=javaxt.dhtml.utils.getRect(this);J=h(a.y,J),Q=g(a.y+a.height,Q)});var $=W.left-q;0>$&&($=0);var tt=W.right-Z;0>tt&&(tt=0),$=g(_.width,$);var et=J-_.top,at=W.height,lt=16,rt=d.xLabel;if(rt){var it=K.append("text").attr("x",(W.right-W.left)/2).attr("y",at+lt).attr("class","chart-axis-label").style("text-anchor","middle").text(rt),nt=javaxt.dhtml.utils.getRect(it.node());at+=nt.height+lt}var ot=d.yLabel;if(ot){var it=X.append("text").attr("transform","rotate(-90)").attr("x",-(_.height/2)).attr("y",-(_.width+lt)).attr("class","chart-axis-label").style("text-anchor","middle").text(ot),nt=javaxt.dhtml.utils.getRect(it.node());$=g($+(nt.width+lt),$)}return{xAxis:K,yAxis:X,xBand:x,yBand:y,x:S,y:D,margin:{top:et,right:tt,bottom:at,left:$}}},getScale:function(t,e,a,l,r,i,n,o){let s,d;switch(e){case"string":s=d3.scaleBand().domain(l.map(function(e){return e[t]})).range(a).padding(.2);break;case"date":var c=[new Date(d3.min(l,e=>e[t])),new Date(d3.max(l,e=>e[t]))];l.map(e=>(e[t]=new Date(e[t]),e)),s=d3.scaleTime().domain(c).rangeRound(a),d=d3.scaleBand().domain(d3.timeDay.range(...s.domain())).rangeRound(a).padding(.2);break;default:var h,u;if(!r){var g=d3.extent(l,function(e){return bluewave.chart.utils.parseFloat(e[t])});h=0,u=g[1]}else h=d3.min(r,function(e){return bluewave.chart.utils.parseFloat(e[t])}),u=d3.max(l,function(e){return bluewave.chart.utils.parseFloat(e[t])});h===u&&(u=h+1),i||(i="linear"),"linear"===i?(0<h&&(h=0),!isNaN(n)&&(h=n),!isNaN(o)&&(u=o),s=d3.scaleLinear().domain([h,u])):"logarithmic"==i&&(1>h&&(h=1),s=d3.scaleLog().domain([h,u+1])),s.range(a)}return{scale:s,band:d}},extendScale:function(t,e,a,l){var i,n,r=Math.ceil,o=t.scale.domain(),s=bluewave.chart.utils.getType;if(l||(l=s(o[0])),a||(a=1),"date"===l){let t=o[1],l=o[0],r=t.getTime(),s=t-l,d=s*a,c=new Date(r+d);i=d3.scaleTime().domain([l,c]).rangeRound(e),n=d3.scaleBand().domain(d3.timeDay.range(...i.domain())).rangeRound(e).padding(.2)}else if("string"===l){let t=r(o.length*a),l="",n=o;for(let e=0;e<t;e++)l+=" ",n.push(l);i=d3.scaleBand().domain(n).range(e).padding(.2)}else{let t=[o[0],o[1]*(a+1)];i=d3.scaleLinear().domain(t).range(e)}return{scale:i,band:n}},reDrawAxes:function(t,e,a,l,r,i){e&&(e.remove(),e=t.append("g").attr("transform","translate(0,"+i+")").call(d3.axisBottom(a))),l&&(l.remove(),l=t.append("g").call(d3.axisLeft(r)))},getType:function(t){var e=bluewave.chart.utils.getType,a=bluewave.chart.utils.isDate,l=bluewave.chart.utils.isNumber,r=bluewave.chart.utils.isCurrency,i=bluewave.chart.utils.isArray;if(i(t)){var n=t.length,o=0,d=0,c=0,h=0,u=0,g=0;return t.forEach(function(t){var a=e(t);switch(a){case"string":var l=(t+"").trim();(0===l.length||"null"===l)&&u++,h++;break;case"number":o++;break;case"currency":d++;break;case"date":c++;break;default:g++}}),c===n||c+u===n?"date":o===n||o+u===n?"number":d===n||d+u===n||d+o+u===n?"currency":h===n?"string":null}switch(typeof t){case"string":return l(t)?"number":a(t)?"date":r(t)?"currency":"string";break;case"number":return"number";break;case"object":if(a(t))return"date";break;default:}return null},parseFloat:function(t){if("number"==typeof t)return t;if("string"==typeof t){if(bluewave.chart.utils.isDate(t))return parseFloat(null);if(bluewave.chart.utils.isCurrency(t))return bluewave.chart.utils.parseCurrency(t)}return parseFloat(t)},parseCurrency:function(t){for(var e=t.split(" "),a=0;a<e.length;a++)if(t=e[a].trim(),bluewave.chart.utils.isCurrency(t)){var l=1;0==t.indexOf("-")&&(l=-1),0==t.indexOf("(")&&t.lastIndexOf(")")==t.length-1&&(l=-1);var r=t.indexOf("."),o=t.indexOf(",");0>r&&(r=0),0>o&&(o=0);var s;return s=r>o&&r?r:!!(o>r&&o)&&o,!1==s?parseFloat(t.replace(/[^\d]/g,""))*l:parseFloat(t.substr(0,s).replace(/[^\d]/g,"")+"."+t.substr(s+1,t.length).replace(/[^0-9]/,""))*l}return parseFloat(null)},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},isNumber:function(t){return!("number"!=typeof t)||("string"!=typeof t&&(t=""+t),!isNaN(parseFloat(t))&&!isNaN(t-0))},isCurrency:function(e){if(bluewave.chart.utils.isNumber(e))return!0;if(bluewave.chart.utils.isDate(e))return!1;"string"!=typeof e&&(e=""+e);var a=e.replace(/[-+,.a-zA-Z0-9() ]+/g,"");if(a=a.replace(/[\$\xA2-\xA5\u058F\u060B\u09F2\u09F3\u09FB\u0AF1\u0BF9\u0E3F\u17DB\u20A0-\u20BD\uA838\uFDFC\uFE69\uFF04\uFFE0\uFFE1\uFFE5\uFFE6]/,""),0<a.length)return!1;for(var l,r=0,o=e.split(" "),s=0;s<o.length;s++){if(l=o[s].trim(),0<l.length){(0==l.indexOf("-")||0==l.indexOf("+"))&&(l=l.substring(1).trim()),0==l.indexOf("(")&&l.lastIndexOf(")")==l.length-1&&(l=l.substring(1,l.length-1).trim());var d=/^\d/.test(l),c=/[0-9]+$/.test(l);if(d&&c){var a=l.replace(/[^0-9,.]+/g,"");return a===l}if(d||c)return bluewave.chart.utils.isNumber(e.replace(/[^0-9.-]+/g,""));r++}if(3<r)return!1}return!1},isDate:function(t){if("string"==typeof t||"number"==typeof t){var e=(t+"").replace(/[^-+0-9,.]+/g,"");if(t===e)return!1}return!isNaN(Date.parse(t))},getDateFormat:function(t){var e="%m/%d/%Y";return t&&(e=t,e=e.replace("YYYY","%Y"),e=e.replace("YY","%y"),e=e.replace("MMMM","%B"),e=e.replace("MM","%m"),e=e.replace("M","%m"),e=e.replace("DD","%d"),e=e.replace("D","%d"),e=e.replace("A","%p"),e=e.replace("dddd","%A"),e=e.replace("HH","%H"),e=e.replace("h","%I"),e=e.replace("mm","%M"),e=e.replace("ss","%S")),e},mixColors:function(t,e,a){if("undefined"!=typeof chroma)return chroma.mix(t,e,a,"rgb").hex();var l=d3.scaleLinear().domain([0,1]).range([t,e]);return d3.color(l(a)).formatHex()},getColorRange:function(t,e){if("undefined"!=typeof chroma)return chroma.scale(e).colors(t);for(var a,l=[-1],r=2/(e.length-1),n=0;n<e.length-2;n++)a=l[l.length-1],l.push(a+r);l.push(1);for(var o=d3.scaleLinear().domain(l).range(e),s=[],n=0;n<t;n++){var d=n/(t-1),c=2*d-1,h=d3.color(o(c)).formatHex();s.push(h)}return s},getNaturalBreaks:function(t,e){var a=Math.min;function l(t,e){var a,r,n=[],o=[],s=0;for(a=0;a<t.length+1;a++){var d=[],c=[];for(r=0;r<e+1;r++)d.push(0),c.push(0);n.push(d),o.push(c)}for(a=1;a<e+1;a++)for(n[1][a]=1,o[1][a]=0,r=2;r<t.length+1;r++)o[r][a]=1/0;for(var h=2;h<t.length+1;h++){for(var u=0,g=0,p=0,y=0,f=1;f<h+1;f++){var x=h-f+1,k=t[x-1];if(p++,u+=k,g+=k*k,s=g-u*u/p,y=x-1,0!==y)for(r=2;r<e+1;r++)o[h][r]>=s+o[y][r-1]&&(n[h][r]=x,o[h][r]=s+o[y][r-1])}n[h][1]=1,o[h][1]=s}return{lower_class_limits:n,variance_combinations:o}}function r(t,e,a){var l=t.length-1,r=[],i=a;for(r[a]=t[t.length-1],r[0]=t[0];1<i;)r[i-1]=t[e[l][i]-2],l=e[l][i]-1,i--;return r}var i=[...new Set(t)].length;if(e=a(e,i-1),e>t.length)return null;t=t.slice().sort(function(t,e){return t-e});var n=l(t,e),o=n.lower_class_limits,s=[];try{s=r(t,o,e),s=[...new Set(s)]}catch(t){console.log(t)}return s},createTooltip:function(){var t=bluewave.chart.utils.Tooltip,e=javaxt.dhtml.utils.getHighestElements;return t||(t=bluewave.chart.utils.Tooltip=d3.select(document.body).append("div").style("opacity",0).style("top",0).style("left",0).style("display","none").attr("class","tooltip"),t.show=function(){var a=e(),l=a.zIndex;a.contains(t.node())||l++,t.style("opacity",1).style("display","block").style("z-index",l)},t.hide=function(){t.style("opacity",0).style("display","none")}),t},setStyle:function(t,e){if(null!==t&&0!==t&&null!==e){var a=t.nodeName;if(!a&&t.node&&(t=t.node(),a=t.nodeName),"string"==typeof e||e instanceof String)t.setAttribute("class",e);else for(var l in e){var r=e[l];"text"===a&&"color"===l&&(l="fill"),t.setAttribute(l,r)}}},clipPolygon:function(t,e){function l([t,e],[a,l],[r,i]){return(r-a)*(e-l)<(i-l)*(t-a)}function r([t,e],[a,l],[r,i],[n,o]){const s=a-t,d=l-e,c=n-r,h=o-i,u=(s*(i-e)-d*(r-t))/(d*c-s*h);return[r+u*c,i+u*h]}function i(t){const[e,a]=t[0],[l,r]=t[t.length-1];return e===l&&a===r}const o=i(e),s=t.length-i(t);e=e.slice();for(let n,h,c,d=0,i=t[s-1];d<s;++d){const a=e.slice(),s=a.length-o;e.length=0,n=t[d],h=a[s-1];for(let t=0;t<s;++t)c=a[t],l(c,i,n)?(!l(h,i,n)&&e.push(r(h,c,i,n)),e.push(c)):l(h,i,n)&&e.push(r(h,c,i,n)),h=c;o&&e.push(e[0]),i=n}return e.length?e:null},createKeyValueDataset:function(e,a,l){var r=[],i=[];e.forEach(t=>{var e=t[a],n=t[l];r.push({key:e+"",value:n}),i.push(n)});var n=bluewave.chart.utils.getType(i);if("number"===n||"currency"===n){r.forEach(t=>{var e=bluewave.chart.utils.parseFloat(t.value);isNaN(e)&&(e=0),t.value=e});var t={};for(var a in r.forEach((e,a)=>{var l=r[a].value;t.hasOwnProperty(e.key)?t[e.key]+=l:t[e.key]=l}),r=[],t)if(t.hasOwnProperty(a)){var o=t[a];r.push({key:a,value:o})}}return r}},!bluewave)var bluewave={};if(bluewave.charts||(bluewave.charts={}),bluewave.charts.BarChart=function(t,e){var a,l,i,n,o,s,d,c=this,r={layout:"vertical",animationSteps:1500,stackValues:!1,borderRadius:0,colors:d3.schemeCategory10,showTooltip:!1},h=[],u=function(){c.setConfig(e),b(t,function(t,e){a=t,l=e})};this.setConfig=function(t){e=t?f(t,r):r},this.getBarColor=function(t,a,l){var r=e.colors,i=e["barColor"+a];return i||(i=r[a%r.length],e["barColor"+a]=i),i},this.getTooltipLabel=function(t,a,l){var r=c.getKeyLabel(t.key,t)+"<br/>"+c.getValueLabel(t.value),i=e.group;if(i&&(i=(i+"").trim(),0<i.length))try{r=i+": "+l[0][e.group]+"<br/>"+r}catch(t){}return r},this.getKeyLabel=function(t,a){var l,r,i=e.layout;return"horizontal"===i?(r=e.xAxis,l=e.yAxis):(l=e.xAxis,r=e.yAxis),l+": "+t},this.getValueLabel=function(t,a){var l,r,i=e.layout;"horizontal"===i?(r=e.xAxis,l=e.yAxis):(l=e.xAxis,r=e.yAxis);var n=bluewave.chart.utils.parseFloat(t);return isNaN(n)||(t=T(n,2)),r+": "+t},this.getXAxis=function(){return s},this.getYAxis=function(){return d},this.clear=function(){l&&l.selectAll("*").remove()},this.addLine=function(t,e,a,l){h.push({line:t,data:e,xAxis:a+"",yAxis:l+""})},this.update=function(t,e){c.clear(),1<arguments.length?c.setConfig(t):e=arguments[0],k(c,function(){g(e)})},this.getSVG=function(){return a};var g=function(t){var u=e,y=javaxt.dhtml.utils.getRect(a.node()),f=y.width,x=y.height,k=x,b=f;i=l.append("g"),i.attr("width",f).attr("height",x);var T=u.layout,S=!0===u.stackValues,E=parseInt(u.borderRadius);(isNaN(E)||0>E)&&(E=0);var F,D,B=u.barType;if("histogram"===B?(F=u.values,D=F):"horizontal"===T?(D=u.xAxis,F=u.yAxis):(F=u.xAxis,D=u.yAxis),null!==F&&void 0!==F&&null!==D&&void 0!==D){var R=t,V=d3.merge(R),P=L(V,F,D);if(0<h.length){let t=d3.max(P,t=>bluewave.chart.utils.parseFloat(t.value));h.forEach(function(e){let a=e.data,l=e.xAxis,r=e.yAxis,i=d3.max(a,t=>bluewave.chart.utils.parseFloat(t[r]));i>t&&(P=L(a,l,r))})}var M=u.sort;M&&P.sort(function(t,e){return d3[M](t.value,e.value)});var O=u.group;if(O&&(O=(O+"").trim(),0===O.length&&(O=null)),O){R=[];var G=d3.group(V,t=>t[O]);for(var z of G.keys()){var Y=G.get(z),K=Y[0][O],j={};for(var z in Y.forEach(t=>{var e=t[F],a=bluewave.chart.utils.parseFloat(t[D]);isNaN(a)&&(a=0),j.hasOwnProperty(e)?j[e]+=a:j[e]=a}),Y=[],j)if(j.hasOwnProperty(z)){var I=j[z],N={};N[O]=K,N[F]=z,N[D]=I,Y.push(N)}R.push(Y)}}else S=!1;var Y=[];for(let t=0;t<R.length;t++){var X=0<t?t+1:"";let e=u[`xAxis${t+1}`],a=u[`yAxis${t+1}`];if(e&&a||O||"histogram"===B||!(0<t)){u.hasOwnProperty(`xAxis${t+1}`)&&u.hasOwnProperty(`yAxis${t+1}`)&&(F=e,D=a);var H=L(R[t],F,D);Y.push(H)}}S?P=L(d3.merge(Y),"key","value"):(P=[],Y.forEach(t=>{P.push(...t)}));var U,W,_,q;"histogram"===B?(_="key",q="key","vertical"===T?(U="Frequency",W=u.xAxis):"horizontal"===T&&(U=u.xAxis,W="Frequency")):"vertical"===T?(_="key",q="value",U=u.yAxis,W=u.xAxis):"horizontal"===T&&(_="value",q="key",U=u.xAxis,W=u.yAxis);var Z=v(i,b,k,_,q,P,null,u,"barChart"),J=Z.margin;if(J){var Q=J.left,$=J.right,tt=J.top,et=J.bottom;(0<tt||0<et||0<Q||0<$)&&(k-=tt+et,b-=Q+$,i.selectAll("*").remove(),i.attr("transform","translate("+Q+","+tt+")"),Z=v(i,b,k,_,q,P,null,u,"barChart")),J={top:tt,right:$,bottom:et,left:Q}}n=Z.x,o=Z.y,s=Z.xAxis,d=Z.yAxis,x-=J.top+J.bottom,f-=J.left+J.right;var at;E&&(at=i.append("defs"));var lt=i.append("g"),rt={};for(let t=0;t<R.length;t++){var it=lt.append("g"),nt=(Math.random()+1).toString(36).substring(7),H=Y[t];let e=parseFloat(u["fillOpacity"+t]);(isNaN(e)||0>e||1<e)&&(e=1);var ot,st,dt,ct;if(S){let t=C(H[0].key);"date"===t&&(t="string"),ot=function(e){return"date"===t?n(new Date(e.key)):n(e.key)},st=function(t){var e=t.key,a=t.value;rt[e]||(rt[e]=0);var l=bluewave.chart.utils.parseFloat(a);return rt[e]+=l,o(rt[e])};let e=function(t){var e=bluewave.chart.utils.parseFloat(t.value);return o(e)};dt=function(t){return n.bandwidth?n.bandwidth():ot(t)},ct=function(t){return o.bandwidth?o.bandwidth():x-e(t)}}else if("histogram"===B){let t=parseInt(u.binWidth);(isNaN(t)||1>t)&&(t=10),n.nice();var ht=d3.histogram().value(function(t){return t.key}).domain(n.domain()).thresholds(n.ticks(t)),ut=ht(H),gt=d3.max(ut,t=>t.length),pt=d3.scaleLinear().range("vertical"===T?[x,0]:[0,f]);pt.domain([0,gt]),"vertical"===T?p(n,pt,k):"horizontal"===T&&p(pt,o,k),ot=function(t){return"vertical"===T?n(t.x0):0},st=function(t){return"vertical"===T?pt(t.length):x-n(t.x1)/(f/x)},dt=function(t){return"vertical"===T?n(t.x1)-n(t.x0)-.5:pt(t.length)},ct=function(t){return"vertical"===T?x-pt(t.length):(n(t.x1)-n(t.x0))/(f/x)-.5}}else{let e=C(H[0].key);"date"===e&&(e="string");var yt=function(t){return"date"===e?n(new Date(t.key)):n(t.key)},mt=function(t){var e=bluewave.chart.utils.parseFloat(t.value);return o(e)};o.bandwidth||n.bandwidth?"vertical"===u.layout?(dt=function(t){return O?n.bandwidth?n.bandwidth()/R.length:yt(t):n.bandwidth?n.bandwidth():yt(t)},ct=function(t){return o.bandwidth?o.bandwidth():x-mt(t)},ot=function(e){var a=dt(e),l=n.bandwidth?yt(e):0;return O?l+a*t:yt(e)},st=mt):"horizontal"===u.layout&&(ot=function(){return 0},st=function(e){var a=o.bandwidth?o.bandwidth()/R.length:x-o(e.key),l=o.bandwidth?o(e.key):0;return O?l+a*t:o(e.key)},dt=function(t){return n.bandwidth?n.bandwidth():n(t.value)},ct=function(t){return O?o.bandwidth?o.bandwidth()/R.length:x-o(t.value):o.bandwidth?o.bandwidth():x-o(t.value)}):"vertical"===u.layout?(ot=function(e){var a=yt(e)-f/H.length/2;if(O){var l=f/H.length,r=l/R.length;a+=r*t}return a},st=mt,ct=function(t){return x-mt(t)},dt=function(t){var e=f/H.length;return O?e/R.length:e-5}):"horizontal"===u.layout&&(ot=function(t){return 0},st=function(t){return"date"===e?o(new Date(t.key))-x/H.length/2:o(t.key)-x/H.length/2},ct=function(t){return x/H.length-5},dt=function(t){return n(t.value)})}E&&(S?(console.log(t),E=0):at.selectAll("*").data(H).enter().append("clipPath").attr("id",function(t,e,a){return"round-corner-"+nt+e}).append("rect").attr("rx",E).attr("ry",E).attr("x",function(t){return"vertical"===u.layout?ot(t):"horizontal"===u.layout?ot(t)-E:void 0}).attr("y",st).attr("height",function(t){return"vertical"===u.layout?ct(t)+E:"horizontal"===u.layout?ct(t):void 0}).attr("width",function(t){return"vertical"===u.layout?dt(t):"horizontal"===u.layout?dt(t)+E:void 0})),it.selectAll("*").data(H).enter().append("rect").attr("x",ot).attr("y",st).attr("height",ct).attr("width",dt).attr("opacity",e).attr("clip-path",function(t,e,a){return E?"url(#round-corner-"+nt+e+")":""}).attr("barID",function(e,a,l){return O?t:0})}var ft=function(t,e){for(var a=[],l=R[t],r=0;r<l.length;r++)l[r][F]===e.key&&a.push(l[r]);return a},xt=lt.selectAll("rect");xt.each(function(t,e){let a=d3.select(this),l=parseInt(a.attr("barID"));var r=ft(l,t);a.attr("fill",c.getBarColor(t,l,r))});var kt=u.animationSteps;if(!isNaN(kt)&&50<kt){var bt;E?(bt=at.selectAll("rect"),bt.attr("yInitial",function(){return this.getAttribute("y")}).attr("heightInitial",function(){return this.getAttribute("height")}).attr("widthInitial",function(){return this.getAttribute("width")})):xt.attr("yInitial",function(){return this.getAttribute("y")}).attr("heightInitial",function(){return this.getAttribute("height")}).attr("widthInitial",function(){return this.getAttribute("width")}),"vertical"===T?bt?(bt.attr("y",x).attr("height",E),bt.transition().duration(kt).attr("y",function(){return parseFloat(this.getAttribute("yInitial"))}).attr("height",function(){return parseFloat(this.getAttribute("heightInitial"))})):(xt.attr("y",x).attr("height",0),xt.transition().duration(kt).attr("y",function(){return parseFloat(this.getAttribute("yInitial"))}).attr("height",function(){return parseFloat(this.getAttribute("heightInitial"))})):"horizontal"===T&&(bt?(bt.attr("width",0),bt.transition().duration(kt).attr("width",function(){return parseFloat(this.getAttribute("widthInitial"))})):(xt.attr("x",0).attr("width",0),xt.transition().duration(kt).attr("width",function(){return parseFloat(this.getAttribute("widthInitial"))})))}var vt;!0===e.showTooltip&&(vt=A());var At=function(t,e){if(vt){let t=d3.select(this),r=parseInt(t.attr("barID"));var a=ft(r,e),l=c.getTooltipLabel(e,r,a);vt.html(l).show()}d3.select(this).transition().duration(100).attr("opacity","0.8")},wt=function(t){vt&&vt.style("top",t.clientY+"px").style("left",t.clientX+20+"px")},Ct=function(){vt&&vt.hide(),d3.select(this).transition().duration(100).attr("opacity","1")},Lt=function(){kt||(kt=0),setTimeout(function(){xt.on("mouseover",At),xt.on("mousemove",wt),xt.on("mouseleave",Ct)},kt)},Tt=function(t){var e=[];return xt.each(function(){e.push(this)}),e};xt.on("click",function(t,e){var a=parseInt(d3.select(this).attr("barID"));c.onClick(this,a,e)}),xt.on("dblclick",function(t,e){c.onDblClick(this,Tt(this))}),h.forEach(function(t){m(t)}),(u.xGrid||u.yGrid)&&w(i,n,o,k,b,u.xGrid,u.yGrid),Lt()}};this.onClick=function(t,e){},this.onDblClick=function(t,e){};var p=function(t,e,a){s&&s.selectAll("*").remove(),d&&d.selectAll("*").remove(),s=i.append("g").attr("transform","translate(0,"+a+")").call(d3.axisBottom(t)),s.selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end"),d=i.append("g").call(d3.axisLeft(e))},m=function(t){var e,a=t.xAxis,l=t.yAxis;t.line.getConfig&&(e=t.line.getConfig()),e||(e=new bluewave.chart.Line().getConfig());let r=e.color,s=e.style,d=e.width,c=e.opacity,h=e.smoothing;var u=function(t){var e=n.bandwidth()/2;return"date"===m?n(new Date(t.key))+e:n(t.key)+e},g=function(t){var e=bluewave.chart.utils.parseFloat(t.value);return o(e)},p=function(){return h&&"none"!==h?d3.line().x(u).y(g).curve(d3[h]):d3.line().x(u).y(g)},y=L(t.data,a,l);let m=C(y[0].key);"date"==m&&(m="string"),i.append("path").datum(y).attr("fill","none").attr("stroke",r).attr("stroke-width",d).attr("opacity",c).attr("stroke-dasharray",function(t){if("dashed"===s)return"5, 5";return"dotted"===s?"0, 5":void 0}).attr("stroke-linecap",function(t){if("dotted"===s)return"round"}).attr("d",p())},f=javaxt.dhtml.utils.merge,k=bluewave.chart.utils.checkSVG,b=bluewave.chart.utils.initChart,v=bluewave.chart.utils.drawAxes,A=bluewave.chart.utils.createTooltip,w=bluewave.chart.utils.drawGridlines,C=bluewave.chart.utils.getType,L=bluewave.chart.utils.createKeyValueDataset,T=javaxt.dhtml.utils.round;u()},!bluewave)var bluewave={};if(bluewave.charts||(bluewave.charts={}),bluewave.charts.MapChart=function(t,e){var r,i,n,o,s,d,c,h,a=Math.abs,l=Math.PI,u=this,g={style:{backgroundColor:"#fff"}},m=!1,f=[],x={},k="Mercator",b=function(){e=R(e,g),M(t,function(t,e){r=t,i=e,r.call(d3.zoom().scaleExtent([1,1]).on("zoom",w)),r.on("click",function(t){var e=u.getProjection();if(e){var a=d3.pointer(t),l=e.invert(a);u.onMouseClick(l[1],l[0],t)}})})};this.addPoints=function(t,e){f.push({type:"points",features:t,config:e})},this.addLines=function(t,e){f.push({type:"lines",features:t,config:e})},this.addPolygons=function(t,e){f.push({type:"polygons",features:t,config:e})},this.addLabels=function(t,e){f.push({type:"labels",features:t,config:e})},this.addGrid=function(t){f.push({type:"grid",features:null,config:t})},this.setBackgroundColor=function(t){e.style.backgroundColor=t,t&&h&&h.attr("fill",t)},this.getProjection=function(){return n},this.setProjection=function(t){k=t,n=d3["geo"+t]()},this.getCentroid=function(t){if(!t)return null;n||u.setProjection("Mercator");var e=d3.geoPath(n);if(V(t)){var a="Point";V(t[0])&&(a="Polygon"),t={type:"Feature",geometry:{type:a,coordinates:t}}}var l=e.centroid(t);return l=n.invert(l),l},this.onRecenter=function(t,e){},this.onRedraw=function(){},this.onMouseClick=function(t,a,l){},this.enablePan=function(){m=!1},this.disablePan=function(){m=!0},this.clear=function(){v(),n=o=s=d=c=null,f=[]};var v=function(){i&&(i.node().innerHTML="",i.attr("transform",null))};this.resize=function(){i},this.setCenter=function(e,a){var r=t.offsetWidth,i=t.offsetHeight;a||(a=r/2/l),n.rotate([-e[0],0]).center([0,e[1]]).scale(a).translate([r/2,i/2])},this.getMidPoint=function(t,e,a){n||u.setProjection("Mercator"),isNaN(e)&&(e=0),a="south"===a?1:-1;var l=t.slice();l[0]=n(l[0]),l[1]=n(l[1]),0>l[1][0]-l[0][0]&&l.reverse();var r=(l[0][0]+l[1][0])/2,i=(l[0][1]+l[1][1])/2,o=l[1][0]-l[0][0],s=l[1][1]-l[0][1],d=[-s*e*a,o*e*a],c=[d[0]+r,d[1]+i];return c=n.invert(c),c},this.update=function(t){v(),P(u,function(e){var a=e.node().parentNode;A(a),t&&t()})},this.getSVG=function(){return r};var A=function(t){v();var a=t.offsetWidth,r=t.offsetHeight,i=parseFloat(e.lat),h=parseFloat(e.lon);return isNaN(i)&&(i=0),isNaN(h)&&(h=0),n||u.setProjection("Mercator"),"AlbersUsa"===k?(n.translate([a/2,r/2]),void L()):void(n.scale(a/2/l).rotate([-h,0]).center([0,i]).translate([a/2,r/2]),o=n.scale(),s=n.translate(),d=n.rotate(),c=n.center(),C(x),L())},w=function(a){var e=u.getProjection();if(e&&!m){var l=javaxt.dhtml.utils.getRect(r.node()),i=l.width,n=l.height,o=a.transform,t=i/2-o.x,h=n/2-o.y,g=e.invert([t,h]),p=d3.scaleLinear().domain([0,n]).range([0,180]),y=d3.scaleLinear().domain([0,i]).range([0,360]),f=s[0]-o.invertX(s[0]),x=s[1]-o.invertY(s[1]),k=p(x)/2+c[1],b=y(f)+d[0];e.rotate([b,d[1],d[2]]),e.center([0,k]),L(),u.onRecenter(g[1],g[0])}};this.getExtent=function(){var t=u.getProjection();if(t){var e=javaxt.dhtml.utils.getRect(r.node()),a=e.width,l=e.height,i=t.invert([0,0]),n=t.invert([a,l]);return{left:i[0],right:n[0],top:i[1],bottom:n[1]}}},this.setExtent=function(t,e,a){x.upperLeft=t,x.lowerRight=e,n?(C(x),a&&a()):u.update(function(){C(x),a&&a()})};var C=function(t,e=10){if(!(0>e||isNaN(e))&&n&&"AlbersUsa"!==k&&t.upperLeft&&t.lowerRight){var l=t.upperLeft,i=t.lowerRight,o=n.scale(),s=u.getExtent(),d=javaxt.dhtml.utils.getRect(r.node()),c=d.width,g=d.height;"Albers"==k&&n.parallels([i[1]+a(i[1]*(1/6)),l[1]-a(l[1]*(1/6))]);var h=n([s.left,s.top]),p=n([s.right,s.bottom]),y=a(h[0]-p[0]),m=a(h[1]-p[1]);n(l)[0]>n(i)[0]&&n.rotate([-l[0]-180,0]);var f,x=n(l),b=n(i),v=a(x[0]-b[0]);f=v/y,n.scale(o/f),x=n(l),b=n(i);var A=[x[0]+c/2,x[1]+g/2],w=n.invert(A);n.rotate([-w[0],0]).center([0,w[1]]),w=u.getMidPoint([l,i]);var L=u.getExtent(),T=a(i[1]-L.bottom);if(i[1]<L.bottom){let t=L.top-L.bottom,e=T/t;e++;let a=n.scale();n.scale(a/e)}n.rotate([-w[0],0]).center([0,w[1]]),C(t,--e)}},L=function(){v();var t=i.append("g");t.attr("name","background"),h=t.append("rect").attr("width","100%").attr("height","100%"),e.style.backgroundColor&&h.attr("fill",e.style.backgroundColor);var a=i.append("g");a.attr("name","layers");var l=d3.geoPath(n);f.forEach(function(t,e){t.config||(t.config={});var r=t.config.name;r||(r="layer"+e);var i=a.append("g");i.attr("name",r),"points"===t.type?T(t,i,l):"lines"===t.type&&S(t,i,l),"polygons"===t.type?F(t,i,l):"labels"===t.type?D(t,i,l):"grid"===t.type&&E(t,i,l)})},T=function(t,e,a){t.config||(t.config={});var l=t.config,r=t.config.style;r||(r={});var i;!0===l.showTooltip&&(i=O());var o=!1;(i||l.onClick)&&(o=!0);var s=r.fill;s||(s="red");var d=r.opacity;d||(d=1);var c=parseInt(r.radius);isNaN(c)&&(c=3),0>c&&(c=1);var h=parseFloat(r.outlineWidth);isNaN(h)&&(h=1);var g=r.outlineColor,p=e.selectAll("*").data(t.features).enter().append("circle").attr("r",function(t){return"function"==typeof r.radius?r.radius(t):c}).attr("transform",function(t){var e=B(t);return e&&(e=n(e)),e?"translate("+e+")":""}).attr("opacity",d).style("fill",s).attr("stroke",g).attr("stroke-width",h).attr("stroke-opacity",d).on("click",function(a,e,r,i){l.onClick&&l.onClick.apply(u,[{feature:e,element:i[r],layer:t,event:a}])});t.elements=p},S=function(t,e,a){t.config||(t.config={});var l=t.config.style;l||(l={});var r=parseInt(l.width);isNaN(r)&&(r=1);var i=l.lineStyle;i||(i="solid");var o=l.smoothing;o&&"none"!==o||(o="curveLinear");var s=l.color;s||(s="red");var d=l.opacity;d||(d=1);var c=e.selectAll("*").data(t.features).enter().append("path").attr("d",function(t){var e=d3.line().curve(d3[o]),a=t.map(t=>n(t));return e(a)}).attr("fill","none").attr("opacity",d).style("stroke",s).style("stroke-width",r).attr("stroke-dasharray",function(t){if("dashed"===i)return"10, 10";return"dotted"===i?"0, 10":void 0}).attr("stroke-linecap",function(t){if("dotted"===i)return"round"});t.elements=c},E=function(t,e,a){t.config||(t.config={});var l=t.config.style;l||(l={});var r=parseInt(l.width);isNaN(r)&&(r=.5);var i=l.lineStyle;i||(i="solid");var n=l.color;n||(n="gray");var o=l.opacity;o||(o=.5);var s=l.longSteps;s||(s=10);var d=l.latSteps;d||(d=10);var c=d3.geoGraticule().step([s,d]),h=e.selectAll("*").data([c()]).enter().append("path").attr("d",a).attr("fill","none").attr("opacity",o).style("stroke",n).style("stroke-width",r).attr("stroke-dasharray",function(t){if("dashed"===i)return"10, 10";return"dotted"===i?"0, 10":void 0}).attr("stroke-linecap",function(t){if("dotted"===i)return"round"});t.elements=h},F=function(t,e,a){t.config||(t.config={});var l=t.config,r=t.config.style;r||(r={});var i,n;!0===l.showTooltip&&(n=l.getTooltipLabel,n&&(i=O()));var o=!1;(i||l.onClick)&&(o=!0);var s=function(a,e){if(i){var r=n(e);i.html(r).show()}var s=d3.select(this);o&&(s.transition().duration(100),s.attr("opacity","0.8")),l.onMouseOver&&l.onMouseOver.apply(u,[{feature:e,element:s,layer:t}])},d=function(t){i&&i.style("top",t.clientY+"px").style("left",t.clientX+20+"px")},c=function(a,e){i&&i.style("opacity",0).style("display","none");var r=d3.select(this);o&&(r.transition().duration(100),r.attr("opacity","1")),l.onMouseLeave&&l.onMouseLeave.apply(u,[{feature:e,element:r,layer:t}])},h=r.fill;h||(h="#DEDDE0");var g=r.stroke;g||(g="#fff");var p=e.selectAll("*").data(t.features).enter().append("path").attr("d",a).attr("fill",function(t){return"function"==typeof r.fill?r.fill(t):h}).attr("stroke",g).style("stroke-width",.4).on("mouseover",s).on("mousemove",d).on("mouseleave",c).on("click",function(a,e,r,i){l.onClick&&l.onClick.apply(u,[{feature:e,element:i[r],layer:t,event:a}])});t.elements=p},D=function(t,e,a){t.config||(t.config={});var l=t.config,r=t.config.style;r||(r={});var i=parseFloat(r.fontSize);isNaN(i)&&(i=12);var o=r.color;o||(o=r.fill),o||(o="#000");var s=r.textAlign;s||(s="left");var d=e.selectAll("text").data(t.features).enter().append("text").attr("transform",function(t){var e=B(t);if(e){e=n(e);var a=e[0],l=e[1];return isNaN(a)||isNaN(l)?"":`translate(  ${a}, ${l}  )`}return""}).attr("font-size",i).attr("text-anchor",()=>"center"==s?"middle":s).style("fill",o).text(e=>e.properties&&t.config.label?e.properties[t.config.label]:"").on("click",function(e,a,r){l.onClick&&l.onClick.apply(u,[{feature:e,element:r[a],layer:t}])});t.elements=d},B=function(t){if(V(t))return t;return t.geometry?t.geometry.coordinates:null},R=javaxt.dhtml.utils.merge,V=bluewave.chart.utils.isArray,P=bluewave.chart.utils.checkSVG,M=bluewave.chart.utils.initChart,O=bluewave.chart.utils.createTooltip;b()},!bluewave)var bluewave={};if(bluewave.charts||(bluewave.charts={}),bluewave.charts.SankeyChart=function(t,a){var r,i,n,l=Math.max,o=this,e={margin:{top:10,right:10,bottom:10,left:10},links:{color:"#ccc",opacity:.3}},s=[],d=[],c=d3.scaleOrdinal(d3.schemeCategory10),h=function(){o.setConfig(a),m(t,function(t,e){r=t,i=e})};this.setConfig=function(t){a=t?p(t,e):e},this.getChart=function(){return n},this.getNodeColor=function(t){return c(t.name.replace(/ .*/,""))},this.getNodeLabel=function(t){return t.name},this.addNode=function(t,e){if(t){var a;return a=t.name?t:{name:t,group:e},s.push(a),a}},this.addLink=function(t,e,a){if(t&&e){t.name&&(t=t.name),e.name&&(e=e.name);var l={source:t,target:e,value:a};return d.push(l),l}},this.clear=function(){u(),s=[],d=[]},this.update=function(t,e){o.setConfig(t),e&&(o.clear(),e.nodes&&(s=e.nodes),e.links&&(d=e.links)),y(o,function(){var t=r.node().parentNode;g(t)})},this.getSVG=function(){return r};var u=function(){i&&i.selectAll("*").remove()},g=function(t){u();var e=t.offsetWidth,r=t.offsetHeight;n=i.append("g"),n.attr("name","sankey").attr("width",e).attr("height",r);var c=d3.sankey().nodeId(t=>t.name).nodeWidth(20).nodePadding(20).iterations([6]).size([e,r]);let h=c({nodes:s,links:d});var g=c.size(),e=g[0],p=d3.format(",.0f"),y=function(t,e){var l;return l="source"===a.links.color?t.source.color:a.links.color,f(l,"white",1-e)},m=n.append("g");m.attr("name","links");var x=m.selectAll("*").data(h.links).enter().append("path").attr("class","sankey-link").attr("d",d3.sankeyLinkHorizontal()).attr("stroke-width",function(t){return l(t.width,1)}).on("mouseover",function(t,e){var l=Math.min(1,1.3*a.links.opacity),r=y(e,l);d3.select(this).style("stroke",r)}).on("mouseout",function(t,e){var l=y(e,a.links.opacity);d3.select(this).style("stroke",l)}),k=n.append("g");k.attr("name","nodes");var b=k.selectAll("*").data(h.nodes).enter().append("g").attr("class","sankey-node");b.append("rect").attr("x",function(t){return t.x0}).attr("y",function(t){return t.y0}).attr("height",function(t){return l(t.y1-t.y0,1)}).attr("width",c.nodeWidth()).style("fill",function(t){return t.color=o.getNodeColor(t)}).style("stroke",function(t){return d3.rgb(t.color).darker(2)}).append("title").text(function(t){return t.name+"\n"+p(t.value)}),x.each(function(){var t=d3.select(this);t.style("stroke",function(t){return y(t,a.links.opacity)})}),x.append("title").text(function(t){return t.source.name+" \u2192 "+t.target.name+"\n"+p(t.value)}),b.append("text").attr("x",function(t){return t.x0-6}).attr("y",function(t){return(t.y1+t.y0)/2}).attr("dy","0.35em").attr("text-anchor","end").text(function(t){return o.getNodeLabel(t)}).filter(function(t){return t.x0<e/2}).attr("x",function(t){return t.x1+6}).attr("text-anchor","start")},p=javaxt.dhtml.utils.merge,y=bluewave.chart.utils.checkSVG,m=bluewave.chart.utils.initChart,f=bluewave.chart.utils.mixColors;h()},!bluewave)var bluewave={};if(bluewave.charts||(bluewave.charts={}),bluewave.charts.LineChart=function(t,e){var r,n,o,s,c,d,h,a=Math.min,l=Math.max,u=this,i={xGrid:!1,yGrid:!1,scaling:"linear",stackValues:!1,endTags:!1,animationSteps:1500},g=[],p=function(){u.setConfig(e),T(t,function(t,e){r=t,n=e})};this.setConfig=function(t){e=t?C(t,i):i,u.setScaling(e.scaling)},this.setScaling=function(t){e.scaling="logarithmic"===t?"logarithmic":"linear"},this.displayEndTags=function(t){e.endTags=!(!0!==t)},this.getXAxis=function(){return d},this.getYAxis=function(){return h},this.clear=function(){m(),g=[]},this.update=function(){L(u,function(){f()})},this.getSVG=function(){return r},this.addLine=function(t,e,a,l){g.push({line:t,data:e,xAxis:a+"",yAxis:l+""})},this.getLayers=function(){return g},this.setLayers=function(t){g=t};var m=function(){n&&n.selectAll("*").remove()},f=function(){m();var t=e,p=g.map(t=>t.data);if(0!==p.length){var y=javaxt.dhtml.utils.getRect(r.node()),f=y.width,x=y.height,w=x,C=f;o=n.append("g"),o.attr("width",f).attr("height",x);var L=t.endTags;!0===L||!1===L||(L=1<p.length);var T=!0===t.stackValues,B=!0===t.accumulateValues,R=[];g.forEach(function(t){t.data&&t.data.forEach(function(e){for(var a=e[t.xAxis],l=!0,r=0;r<R.length;r++)if(R[r]==a){l=!1;break}l&&R.push(a)})});var V=[];for(let t=0;t<g.length;t++){if(!g[t].line)continue;let e=g[t].xAxis,a=g[t].yAxis;if(e&&a){var P=D(g[t].data,e,a),M=g[t].line.getConfig();B&&P.forEach(function(t,e){var a=P[e].value;isNaN(a)&&(P[e].value=0),0<e&&(P[e].value+=P[e-1].value)});var O=M.smoothing;if(O){var G=M.smoothingValue;A(O,G,P)}V.push({lineConfig:M,sumData:P})}}if(T){if(B)V.sort(function(t,e){return t=t.sumData,t=t[t.length-1].value,e=e.sumData,e=e[e.length-1].value,e-t});else{var z=[];V.forEach(function(t){var e=t.sumData,a=0;e.forEach(t=>a+=t.value),z.push({sumValue:a,sumData:e,lineConfig:t.lineConfig})}),z.sort(function(t,e){return e.sumValue-t.sumValue}),V=[],z.forEach(t=>V.push({sumData:t.sumData,lineConfig:t.lineConfig}))}var Y=S(R),K={};V.forEach(function(t,e){var a=t.sumData,l="none",r=0,i=0,n=0;if(2>a.length);else{for(var o=0;o<a.length-1;o++){var s=a[o].key,d=a[o+1].key;if("date"==Y)s=new Date(s).getTime(),d=new Date(d).getTime(),d>=s&&r++,d<=s&&i++;else if("number"==Y||"currency"==Y)s=bluewave.chart.utils.parseFloat(s),d=bluewave.chart.utils.parseFloat(d),d>s&&r++,d<s&&i++,d==s&&n++;else{var c=s.localeCompare(d);0>c&&r++,0<c&&i++,0==c&&n++}}r+n==a.length-1&&(l="asc"),i+n==a.length-1&&(l="desc");var h=K[l];h||(h=[],K[l]=h),h.push(e)}});var j=Object.keys(K),I=1==j.length?j[0]:null;I&&R.sort(function(t,e){return"number"==Y||"currency"==Y?"asc"==I?bluewave.chart.utils.parseFloat(t)-bluewave.chart.utils.parseFloat(e):bluewave.chart.utils.parseFloat(e)-bluewave.chart.utils.parseFloat(t):"date"==Y?"asc"==I?new Date(t).getTime()-new Date(e).getTime():new Date(e).getTime()-new Date(t).getTime():"asc"==I?t.localeCompare(e):e.localeCompare(t)}),V.forEach(function(t){var e=t.sumData,a=[];for(R.forEach(function(t){for(var l,r=0;r<e.length;r++){var n=e[r].key,o=e[r].value;if(n==t){l=o;break}}a.push({key:t,value:l})});0<a.length;){var l=a[0].value;if(!isNaN(l))break;isNaN(l)&&a.shift()}t.sumData=a});var N=[];V.forEach(function(t,e){var a=t.sumData,l=[];a.forEach(function(t){l.push({key:t.key,value:t.value})}),a.forEach(function(t,e){var r=t.key,i=t.value;if(isNaN(i)){for(var o,s=e-1;-1<s;s--)if(o=a[s].value,!isNaN(o)){i=o;break}isNaN(i)&&(i=0)}for(var c,h,u=0;u<N.length;u++)h=N[u].sumData,h.every(function(t){var e=t.key,a=t.value;return!!(e!=r||isNaN(a))||(c=a,!1)});isNaN(c)||(i+=c),l[e].value=i}),N.push({lineConfig:t.lineConfig,sumData:l})}),V=N}var X=[],H=[];V.forEach(function(t){var e=t.sumData;R.forEach(function(t){t instanceof Date&&!T?t+="":!isNaN(t)&&!T&&(t+="");for(var r=0;r<e.length;r++){var n=e[r],o=n.key;if(o===t){for(var s,c=n.value,h=!1,u=0;u<X.length;u++)s=X[u],s.key==t&&(h=!0,s.value=a(s.value,c));h||X.push({key:t,value:c});for(var s,h=!1,u=0;u<H.length;u++)s=H[u],s.key==t&&(h=!0,s.value=l(s.value,c));h||H.push({key:t,value:c})}}})});var U=E(o,C,w,"key","value",H,X,e),W=U.margin;if(W){var _=W.left,q=W.right,Z=W.top,J=W.bottom;if(L){var Q=0,$=0;g.forEach(function(t,e){if(t.line){var a=t.line.getLabel();if(a||(a="Series "+(e+1)),a){var r=o.append("text").attr("dy",".35em").attr("text-anchor","start").text(a),i=r.node().getBBox();r.remove();var n=l(i.width+8,60)+5;$=i.height,Q=l(n,Q)}}}),q=Q+5,0<$&&(Z=l($/2,Z))}(0<Z||0<J||0<_||0<q)&&(w-=Z+J,C-=_+q,o.selectAll("*").remove(),o.attr("transform","translate("+_+","+Z+")"),U=E(o,C,w,"key","value",H,X,e)),W={top:Z,right:q,bottom:J,left:_}}s=U.x,c=U.y,d=U.xAxis,h=U.yAxis;var tt=[];for(let t=0;t<V.length;t++)tt.push({area:null,line:null,line2:null,tag:null,point:null});var et=o.append("g");et.attr("name","fill");for(let t=V.length-1;-1<t;t--){var P=V[t].sumData;let a=V[t].lineConfig.fill,l=a.color,r=a.startOpacity,i=a.endOpacity;var O=V[t].lineConfig.smoothing;let n=S(P[0].key);var at=function(t){return"date"===n?s(new Date(t.key)):s(t.key)},lt=function(t){var a=bluewave.chart.utils.parseFloat(t.value);return"logarithmic"===e.scaling?c(a+1):c(a)};if(0===r&&0===i)continue;let o="fill-gradient-"+t;b(l,r,i,o,et),tt[t].area=et.append("path").datum(P).attr("fill",`url(#${o})`).attr("d",d3.area().x(at).y0(w).y1(lt))}var rt=o.append("g"),it=o.append("g");it.attr("name","circles"),rt.attr("name","lines");for(let t=0;t<V.length;t++){var P=V[t].sumData;let e=V[t].lineConfig,a=e.point,l=e.color,r=e.style,i=e.width,n=e.opacity,o=a.radius,s=a.color;var O=e.smoothing,nt=function(){return O&&"spline"===O?d3.line().x(at).y(lt).curve(d3.curveMonotoneX):d3.line().x(at).y(lt)};if(tt[t].line=rt.append("path").datum(P).attr("fill","none").attr("stroke",l).attr("stroke-width",i).attr("opacity",n).attr("stroke-dasharray",function(t){return"dashed"===r?"5, 5":"dotted"===r?"0, 5":void 0}).attr("stroke-linecap",function(t){if("dotted"===r)return"round"}).attr("d",nt()),tt[t].line2=rt.append("path").datum(P).attr("dataset",t).attr("fill","none").attr("stroke","#ff0000").attr("stroke-width",10).attr("opacity",0).attr("d",nt()).on("click",function(t,e){var a=parseInt(d3.select(this).attr("dataset"));v(tt[a]),u.onClick(this,a,e)}),o&&(tt[t].point=it.selectAll("points").data(P).enter().append("circle").attr("dataset",t).attr("fill",s).attr("stroke","none").attr("cx",at).attr("cy",lt).attr("r",o).on("click",function(t,e){var a=parseInt(d3.select(this).attr("dataset"));v(tt[a]),u.onClick(this,a,e)})),L){var ot=e.label;ot||(ot="Series "+(t+1));var st=tt[t].line2;tt[t].tag=k(P,l,ot,st)}}var dt=t.animationSteps;if(!isNaN(dt)&&50<dt){let t=rt.selectAll("path"),a=it.selectAll("circle"),l=et.selectAll("path"),r=d3.min(X,t=>bluewave.chart.utils.parseFloat(t.value)),i="logarithmic"===e.scaling?c(r):c(0);if(t.attr("d",d3.line().x(at).y(i)),a.attr("cx",at).attr("cy",i),l.attr("d",d3.area().x(at).y0(w).y1(i)),t.transition().duration(dt).attr("d",nt()),a.transition().duration(dt).attr("cx",at).attr("cy",lt),l.transition().duration(dt).attr("d",d3.area().x(at).y0(w).y1(lt)),L)for(var ct=0;ct<tt.length;ct++){var ht=tt[ct].tag.poly,ut=tt[ct].tag.text,gt=ht.attr("transform"),pt=ut.attr("transform"),yt=gt.slice(10).split(",")[0],mt=pt.slice(10).split(",")[0];ht.attr("transform","translate("+yt+","+(w-9.6)+")"),ut.attr("transform","translate("+mt+","+w+")"),ht.transition().duration(dt).attr("transform",gt),ut.transition().duration(dt).attr("transform",pt)}}(t.xGrid||t.yGrid)&&F(o,s,c,w,C,t.xGrid,t.yGrid)}};this.onClick=function(t,e,a){};var k=function(t,r,i,n){var d=t[t.length-1],u=d.key,g=d.value,p=S(t[0].key);if("date"===p)var y=s(new Date(u));else var y=s(u);var m="logarithmic"===e.scaling?c(g+1):c(g),f=o.append("text").attr("dy",".35em").attr("text-anchor","start").text(i),x=f.node().getBBox();f.remove();var k=l(x.width+8,60),b=x.height,h=b/2,a=[[0,0],[k,0],[k,b],[0,b],[-h,h]],v=o.append("polygon").attr("points",a.join(" ")).attr("transform","translate("+(y+h)+","+(m-h)+")").style("fill",r).on("click",function(t,e){n.dispatch("click")}),A=o.append("text").attr("transform","translate("+(y+h+4)+","+m+")").attr("dy",".35em").attr("text-anchor","start").style("fill","#fff").text(i).on("click",function(t,e){n.dispatch("click")});return{poly:v,text:A}},b=function(t,e,a,l,r){null==e&&(e=0),null==a&&(a=0),r.append("defs").append("linearGradient").attr("id",l).attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%").selectAll("stop").data([{offset:"0%",color:t,opacity:e},{offset:"100%",color:t,opacity:a}]).enter().append("stop").attr("offset",t=>t.offset).attr("stop-color",t=>t.color).attr("stop-opacity",t=>t.opacity)},v=function(t){if(t){t.line.raise(),t.line2.raise(),t.point&&t.point.raise();var e=t.tag;if(e){var a=e.poly.node().parentNode,l=e.poly.node().cloneNode(!0),r=e.text.node().cloneNode(!0);e.poly.remove(),e.text.remove(),a.appendChild(l),a.appendChild(r),t.tag.poly=d3.select(l),t.tag.text=d3.select(r)}}},A=function(t,e,a){if("movingAverage"===t){if(!isNaN(e)&&0<e){function t(t,e){let a=[t[0]],l=0;for(let r=1;r<e;r++)l+=t[r],a.push(l/r);for(let l,r=e;r<t.length;r++)l=d3.mean(t.slice(r-e/2,r+e/2)),a.push(l);return a}var l=a.map(t=>t.value);let r=t(l,e);a.forEach(function(t,e){t.value=r[e]})}}else if("kde"===t){var l=a.map(t=>t.value),r=l.length,n=d3.extent(l),o=n[0],s=n[1],c=l.reduce((t,e)=>t+e,0),h=(s-o)/r;h=Math.round(h);for(var u=[],g=0;g<l.length;g++)for(var d=0;d<l[g];d++)u.push(g+.5),d+=h;for(var p,y=[],m=w(e),g=0;g<l.length;g++)p=d3.mean(u,function(t){return m(g-t)}),y.push([g,p]);a.forEach(function(t,e){t.value=y[e][1]*c})}},w=function(t){return e=>1>=Math.abs(e/=t)?.75*(1-e*e)/t:0},C=javaxt.dhtml.utils.merge,L=bluewave.chart.utils.checkSVG,T=bluewave.chart.utils.initChart,S=bluewave.chart.utils.getType,E=bluewave.chart.utils.drawAxes,F=bluewave.chart.utils.drawGridlines,D=bluewave.chart.utils.createKeyValueDataset;p()},!bluewave)var bluewave={};if(bluewave.charts||(bluewave.charts={}),bluewave.charts.TreeMapChart=function(t,e){var l,r,n,o,s,a=Math.max,c=this,i={key:"name",value:"value",shape:"square",groupBy:null,colors:d3.schemeCategory10,keyLabel:!0,valueLabel:!0,groupLabel:!0,showTooltip:!1,style:{keyLabel:{"font-size":"14px",color:"#fff"},valueLabel:{"font-size":"11px",color:"#fff"},groupLabel:{"font-size":"16px"}}},d=function(){c.setConfig(e),C(t,function(t,e){l=t,r=e})};this.setConfig=function(t){e=t?v(t,i):i,n=!(!0!==e.showTooltip)&&L()},this.getTooltipLabel=function(t,e){var a=t.name;return t.group&&0<t.group.length&&(a+=" ("+t.group+")"),a+"<br/>"+c.getValueLabel(t.value)},this.getKeyLabel=function(t,e){return t},this.getValueLabel=function(t,e){var a=bluewave.chart.utils.parseFloat(t);return isNaN(a)?t:w(a,2)},this.onClick=function(t,e){},this.onDblClick=function(t,e){},this.clear=function(){r&&r.selectAll("*").remove(),s=null},this.update=function(t,e,a){c.clear(),1<arguments.length?c.setConfig(t):e=arguments[0],A(c,function(){g(e),a&&a()})},this.getSVG=function(){return l},this.getGroup=function(t){var e=[];return s&&s.each(function(a){if(a.data.group===t){var l=d3.select(this).node();e.push({cell:l,rect:l,data:a.data})}}),e},this.getGroups=function(){var t={};for(var e in s&&s.each(function(e){var a=e.data.group;t[a]=[]}),t)t.hasOwnProperty(e)&&(t[e]=c.getGroup(e));return t};var h=(t,e,a)=>{if(!t)return null;if(Array.isArray(t))for(const l of t){const t=h(l,e,a);if(t)return l}else{if(t.hasOwnProperty(e)&&t[e]===a)return t;for(const l of Object.keys(t))if("object"==typeof t[l]){const r=h(t[l],e,a);if(null!==r&&"undefined"!=typeof r)return r}return null}},u=function(t){var a=[],l=null;if(null!==e.groupBy){var l=(e.groupBy+"").trim();if(0<l.length){var r={};t.forEach(t=>{var e=t[l];r[e]=!0}),a=Object.keys(r)}else l=null}var n=[];t.forEach(t=>{var a=t[e.value],l=bluewave.chart.utils.parseFloat(a);0==l||isNaN(l)||(t[e.value]=l,n.push(t))}),n.length!==t.length&&(t=n);var o={children:[],name:"all"};if(null!==l){a.forEach(a=>{o.children.push({name:a,children:[],colname:"level2"});var r=h(o.children,"name",a);t.forEach(t=>{var i=t[e.key],n=t[l],o=t[e.value];if(a===n)if("undefined"!=typeof h(r.children,"name",i)){var s=h(r.children,"name",i);s.value+=o}else r.children.push({name:i,group:n,colname:"level3",value:o})})});var s={};o.children.forEach(t=>{var e=0;t.children.forEach(t=>{e+=t.value}),s[t.name]=e});var c=[];for(var u in s)if(s.hasOwnProperty(u)){var g=s[u];0==g&&c.push(u)}for(;0<c.length;)for(var p=c.shift(),y=0;y<o.children.length;y++)if(o.children[y].name==p){o.children.splice(y,1);break}o.children.sort((t,e)=>s[e.name]-s[t.name]),a=[],o.children.forEach(t=>{a.push(t.name)})}else{o.children.push({name:"",children:[],colname:"level2"});var m=h(o.children,"name","");t.forEach(t=>{var a=t[e.key],l=t[e.value],r="";if("undefined"!=typeof h(m.children,"name",a)){var i=h(m.children,"name",a);i.value+=l}else m.children.push({name:a,group:r,colname:"level3",value:l})})}var f=d3.hierarchy(o).sum(t=>t.value),x=f.leaves(),k=f.descendants().filter(t=>1==t.depth);return{root:f,leaves:x,descendants:k,groupNames:a,children:o.children}},g=function(t){t=u(t);var a=t.groupNames;("undefined"==typeof a||null===a)&&(a=[]);var r=e.colors,i=a.length;i>r.length&&(r=S(i,r)),o=function(t){for(var e=r[0],l=0;l<a.length;l++)if(a[l]===t){e=r[l];break}return e};var n=javaxt.dhtml.utils.getRect(l.node());"circle"===e.shape?y(t,n):p(t,n)},p=function(t,l){var i=0;if(e.groupLabel&&1<t.descendants.length){var n=r.append("text").attr("x",0).attr("y",0).attr("text-anchor","start").text("Iq");T(n,e.style.groupLabel),i=n.node().getBBox().height,n.remove()}d3.treemap().size([l.width,l.height]).paddingTop(i).paddingInner(0)(t.root);var u=function(e,a){var l=h(t.children,"name",a),r=[];l.children.forEach(t=>{r.push(t.value)});var i=d3.scaleLinear().domain([d3.min(r),d3.max(r)]).range([.5,1]);return i(e)};s=r.selectAll("rect").data(t.leaves).enter().append("rect").attr("x",t=>t.x0).attr("y",t=>t.y0).attr("width",t=>t.x1-t.x0).attr("height",t=>t.y1-t.y0).style("stroke","white").style("fill",t=>o(t.parent.data.name)).style("opacity",t=>u(t.data.value,t.data.group)).on("mouseover",f).on("mousemove",x).on("mouseleave",k).on("click",function(t,e){c.onClick(this,e.data)}).on("dblclick",function(t,e){c.onDblClick(this,e.data)});var g=[],p=3;if(e.keyLabel&&s.each(function(a){var l=c.getKeyLabel(a.data.name,a.data),i=d3.select(this).node(),n=i.getBBox(),o=n.x+n.width,s=n.y+n.height,d=r.append("text").attr("x",n.x+2).attr("y",n.y).attr("text-anchor","start").text(l);T(d,e.style.keyLabel);var h=d.node().getBBox();d.attr("y",n.y+h.height/2+p),h=d.node().getBBox();var u=h.x+h.width,y=h.y+h.height,m=0;u>o?d.remove():y>s?d.remove():m=h.y+h.height,g.push(m)}),e.valueLabel&&s.each(function(a,l){var i=g[l];if(!(0===i&&e.keyLabel)){var n=c.getValueLabel(a.data.value,a.data),o=d3.select(this).node(),s=o.getBBox(),d=s.x+s.width,h=s.y+s.height,u=r.append("text").attr("x",s.x+2).attr("y",s.y).attr("text-anchor","start").text(n);T(u,e.style.valueLabel);var p=u.node().getBBox();u.attr("y",i+p.height/2),p=u.node().getBBox();var y=p.x+p.width,m=p.y+p.height;y>d?u.remove():m>h&&u.remove()}}),e.groupLabel&&0<i){var y=r.selectAll("titles").data(t.descendants).enter().append("text").attr("x",t=>t.x0+1).attr("y",t=>t.y0+i-p).text(t=>t.data.name).attr("fill",t=>o(t.data.name)),m=[];y.each(function(t,l){T(this,e.style.groupLabel);var r=this.getBBox(),i=r.x+r.width,n=0;t.children.forEach(t=>{n=a(t.x1,n)}),i>n&&m.push(d3.select(this))}),m.forEach(t=>{t.remove()})}},y=function(t,a){var l=a.width,i=a.height,n=Math.min(l,i)/2-5,d=[l/2,i/2],h=r.append("g").attr("transform","translate("+d+")"),u=m(60,n);h.append("path").attr("transform","translate("+[-n,-n]+")").attr("d","M"+u.join(",")+"Z"),d3.voronoiTreemap().clip(u)(t.root),s=h.append("g").attr("transform","translate("+[-n,-n]+")").selectAll("path").data(t.leaves).enter().append("path").attr("d",function(t){return"M"+t.polygon.join(",")+"z"}).style("fill",t=>o(t.parent.data.name)).style("stroke","white").on("mouseover",f).on("mousemove",x).on("mouseleave",k).on("click",function(t,e){c.onClick(this,e.data)}).on("dblclick",function(t,e){c.onDblClick(this,e.data)});var g,p;(e.keyLabel||e.valueLabel)&&(g=h.append("g").attr("transform","translate("+[-n,-n]+")"),p=[],s.each(function(t){var e=d3.polygonCentroid(t.polygon);p.push(e)}));var y=[];e.keyLabel&&s.each(function(a,l){var r=c.getKeyLabel(a.data.name,a.data),i=p[l],n=g.append("text").attr("x",i[0]).attr("y",i[1]).attr("text-anchor","middle").attr("dominant-baseline","middle").text(r);T(n,e.style.keyLabel);var o=0;if(b(n,a))n.remove();else{var s=n.node().getBBox();o=s.y+s.height+4}y.push(o)}),e.valueLabel&&s.each(function(a,l){var r=y[l];if(!(0===r&&e.keyLabel)){var i=c.getValueLabel(a.data.value,a.data),n=p[l],o=g.append("text").attr("x",n[0]).attr("y",r).attr("text-anchor","middle").attr("dominant-baseline","middle").text(i);T(o,e.style.valueLabel);var s=o.node().getBBox();s.y<r&&o.attr("y",r),b(o,a)&&o.remove()}})},m=function(t,e){for(var l=2*Math.PI/t,r=[],n=0,o=0;o<t;o++,n+=l)r.push([e+e*Math.cos(n),e+e*Math.sin(n)]);return r},f=function(t,e){if(n){var a=s.nodes().indexOf(this),l=c.getTooltipLabel(e.data,a);n.html(l).show()}d3.select(this).transition().duration(100).attr("opacity","0.8")},x=function(t){n&&n.style("top",t.clientY+"px").style("left",t.clientX+20+"px")},k=function(){n&&n.hide(),d3.select(this).transition().duration(100).attr("opacity","1")},b=function(e,l){var r=e.node().getBBox(),t=[[r.x,r.y],[r.x+r.width,r.y],[r.x+r.width,r.y+r.height],[r.x,r.y+r.height],[r.x,r.y]],n=bluewave.chart.utils.clipPolygon(l.polygon,t),o=!0;if(!n)o=!1;else if(5===n.length){for(var s=0,d=0;d<n.length;d++){var c=n[d],h=t[d];c[0]===h[0]&&c[1]===h[1]&&s++}5===s&&(o=!1)}return o},v=javaxt.dhtml.utils.merge,A=bluewave.chart.utils.checkSVG,w=javaxt.dhtml.utils.round,C=bluewave.chart.utils.initChart,L=bluewave.chart.utils.createTooltip,T=bluewave.chart.utils.setStyle,S=bluewave.chart.utils.getColorRange;d()},!bluewave)var bluewave={};bluewave.charts||(bluewave.charts={}),bluewave.charts.PieChart=function(t,e){var d,c,h,a=Math.round,l=Math.abs,r=Math.PI,i=Math.min,n=Number.MAX_VALUE,o=Math.max,u=this,s={pieKey:"key",pieValue:"value",pieCutout:0,pieSort:!1,pieSortDir:"ascending",maximumSlices:null,showLabels:!0,labelOffset:100,showSum:!1,lineColor:"#777",borderColor:"#777",extendLines:!1,colors:["#6699cc","#f8f8f8"],otherColor:"#b8b8b8",animationSteps:1500},g=function(){u.setConfig(e),v(t,function(t,e){d=t,c=e})};this.setConfig=function(t){e=t?x(t,s):s},this.getTooltipLabel=function(t,e){return u.getKeyLabel(t.key,t)+"<br/>"+u.getValueLabel(t.value)},this.getKeyLabel=function(t,e){return t},this.getValueLabel=function(t,e){var a=bluewave.chart.utils.parseFloat(t);return isNaN(a)?t:T(a,2)},this.getCenterLabel=function(t){var e=0;t.forEach(t=>{e+=t.value});var l="";return 1e3<=e&&(e=a(e/1e3),l="k",1e3<=e&&(e=a(e/1e3),l="M",1e3<=e&&(e=a(e/1e3),l="B"),1e3<=e&&(e=a(e/1e3),l="T"))),e+l},this.getNumSlices=function(){return h},this.clear=function(){p(),h=0},this.update=function(t,a,l){p(),0<arguments.length&&(1===arguments.length||("string"==typeof a?(e.pieKey=a,e.pieValue=l):(u.setConfig(arguments[0]),t=arguments[1]))),k(u,function(){y(t)})},this.getSVG=function(){return d};var p=function(){c&&(c.node().innerHTML="",c.attr("transform",null))},y=function(t){if(b(t)&&b(t[0])&&(t=t[0]),e.pieKey&&e.pieValue){var a=L(t,e.pieKey,e.pieValue),n=(e.pieSort+"").toLowerCase(),o=(e.pieSortDir+"").toLowerCase(),s=parseFloat(e.maximumSlices);"key"===n?a.sort(function(t,e){return m(t.key,e.key,o)}):"value"===n?a.sort(function(t,e){return m(t.value,e.value,o)}):s=null,h=a.length;var g=!1;if(!isNaN(s)&&0<s&&s<h){var p;if("descending"===o?(p=a.slice(s),a=a.slice(0,s)):(p=a.slice(0,h-s),a=a.slice(h-s,h)),!0===e.showOther){var k=0;p.forEach(function(t){var e=t.value;isNaN(e)||(k+=e)}),a.push({key:"Other",value:k}),g=!0}h=a.length}var v=0;"undefined"!=typeof e.piePadding&&(v=e.piePadding*r/180);var T=d3.pie().value(function(t){return t.value}).sort(null).padAngle(v);a=T(a);var S=javaxt.dhtml.utils.getRect(d.node()),E=S.width,F=S.height,D=c.append("g");D.attr("transform","translate("+E/2+","+F/2+")");var B=i(E,F)/2,R=parseFloat(e.pieCutout);isNaN(R)&&(R=.65);var V,P=B*R;!0===e.showTooltip&&(V=C());var M=function(t,e){if(V){var a=u.getTooltipLabel(e.data);V.html(a).show()}d3.select(this).transition().duration(100).attr("opacity","0.8")},O=function(t){V&&V.style("top",t.clientY+"px").style("left",t.clientX+20+"px")},G=function(){V&&V.hide(),d3.select(this).transition().duration(100).attr("opacity","1")},z=e.colors,Y=g?h-1:h;Y>e.colors.length&&(z=A(Y,z)),g&&z.push(e.otherColor);var K=d3.arc().innerRadius(P).outerRadius(B),j=D.append("g");j.attr("name","pie"),j.selectAll("*").data(a).enter().append("path").attr("d",K).attr("fill",function(t,e){return z[e]}).attr("stroke",e.borderColor).style("stroke-width","1px").on("mouseover",M).on("mousemove",O).on("mouseleave",G);var I=!0===e.showSum;if(I&&0<R){var N=u.getCenterLabel(a);if(N){var X=D.append("text").attr("text-anchor","middle").attr("font-size","4em").attr("y",20);X.text(N)}}var H,U=!0===e.showLabels;if(U&&"undefined"!==a[0].data.key&&!isNaN(a[0].value)){H=D.append("g"),H.attr("name","labels");var W=parseFloat(e.labelOffset);(isNaN(W)||0>W)&&(W=100);var _=0;if(100<W)_=B*(W/100);else{var q=B-P;_=P+q*(W/100)}var w=!0===e.extendLines;w&&110>=W&&(w=!1);var Z,J=d3.arc().innerRadius(P).outerRadius(P+90*(B-P)/50),Q=d3.arc().innerRadius(B).outerRadius(B+2*(_-B)),$=!1;let t=[];var tt=D.append("g");tt.attr("name","lines"),tt.selectAll("*").data(a).enter().append("polyline").attr("opacity","0").attr("stroke",e.lineColor).style("fill","none").attr("stroke-width",1).attr("points",function(e){var l=J.centroid(e),a=Q.centroid(e),i=[l,a],n=e.startAngle+(e.endAngle-e.startAngle)/2,o=!!(n<r);return w&&i.push([_*(o?1:-1),a[1]]),t.push(i[i.length-1]),i}),110<W&&tt.selectAll("polyline").attr("opacity","1"),H.selectAll("*").data(a).enter().append("text").text(function(t){return u.getKeyLabel(t.data.key,t.data)}).attr("transform",function(e,a){return"translate("+t[a]+")"}).style("text-anchor",function(t,e){if(e==h-1&&!w)return"middle";var a=t.startAngle+(t.endAngle-t.startAngle)/2;return a<r?"start":"end"});var et=f(c);if(et.width=1.1*(et.maxX-et.minX),et.height=1.1*(et.maxY-et.minY),et.width>E||et.height>F){var at,lt,rt,it=et.width-E,nt=et.height-F;it>nt?(at=E/et.width,1<at&&(at=1+(1-at)),lt=E/2,rt=F/2):nt>it&&(at=F/et.height,lt=E/2,rt=et.height),D.attr("transform","translate("+lt+","+rt+") scale("+at+")");var rt=S.y,lt=S.x,ot=S.x+S.width/2,st=S.y+S.height/2,S=javaxt.dhtml.utils.getRect(D.node()),dt=(F-S.height)/2,ct=(E-S.width)/2,ht=S.x+S.width/2,ut=S.y+S.height/2,ct=ot-ht,dt=st-ut;0>dt&&(dt=0),0>ct&&(ct=0),D.attr("transform","translate("+(E/2+ct)+","+(F/2+dt)+") scale("+at+")")}}var gt=e.animationSteps;if(!isNaN(gt)&&50<gt){var pt=0;gt/=2;var yt=j.selectAll("path"),mt=d3.arc().innerRadius(0).outerRadius(0);if(yt.attr("d",mt),yt.transition().delay(function(t,e){var a=l(t.startAngle-t.endAngle)+t.padAngle,i=a/(2*r),n=pt,o=i*gt;return pt+=o,n}).duration(function(t){var e=l(t.startAngle-t.endAngle)+t.padAngle,a=e/(2*r);return a*gt}).ease(d3.easeLinear).attrTween("d",function(e){var a=d3.interpolate(e.startAngle,e.endAngle);return function(l){return e.endAngle=a(l),K(e)}}),U){var ft=H.selectAll("text"),xt=tt.selectAll("polyline");xt.attr("opacity",0),ft.attr("opacity",0);var kt=function(t,e){return e*gt/h};110<W&&xt.transition().delay(kt).duration(gt).attr("opacity",1),ft.transition().delay(kt).duration(gt).attr("opacity",1)}}}},m=function(t,e,a){var l="string"==typeof t&&"string"==typeof e;return a=(a+"").toLowerCase(),"descending"===a?l?e.localeCompare(t):e-t:l?t.localeCompare(e):t-e},f=function(t){var e=n,a=0,l=n,r=0;return t.selectAll("*").each(function(){var t=javaxt.dhtml.utils.getRect(d3.select(this).node());e=i(t.left,e),a=o(t.right,a),l=i(t.top,l),r=o(t.bottom,r)}),{minX:e,maxX:a,minY:l,maxY:r}},x=javaxt.dhtml.utils.merge,k=bluewave.chart.utils.checkSVG,b=bluewave.chart.utils.isArray,v=bluewave.chart.utils.initChart,A=bluewave.chart.utils.getColorRange,C=bluewave.chart.utils.createTooltip,L=bluewave.chart.utils.createKeyValueDataset,T=javaxt.dhtml.utils.round;g()};
